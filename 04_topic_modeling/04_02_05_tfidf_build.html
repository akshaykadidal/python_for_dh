
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>TF-IDF with Scikit Learn &#8212; Introduction to Python for Humanists</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/chapman-logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Python for Humanists</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    <p align="center">INTRODUCTION TO PYTHON FOR HUMANISTS</p>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PREFACE
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00_preface/00_01_preface.html">
   Preface
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PART ONE: The Basics of Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_intro/01_01-01_intro.html">
   1. Introduction to Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_01-02_introduction_to_python.html">
     1.1. Introduction to Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_01-03_installing_python.html">
     1.2. Installing Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_01-04_coding_basics.html">
     1.3. Coding Basics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_intro/01_02-01_intro.html">
   2. Data and Data Structures
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_02-02_data.html">
     2.1. Introduction to Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_02-03_data_structures.html">
     2.2. Introduction to Data Structures
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_intro/01_03-01_intro.html">
   3. Loops and Logic
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_03-02_loops.html">
     3.1. Introduction to Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_03-03_conditionals.html">
     3.2. Conditionals
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_intro/01_04-01_intro.html">
   4. Formal Coding: Functions, Classes, and Libraries
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_04-02_functions.html">
     4.1. Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_04-03_classes.html">
     4.2. Classes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_04-04_libraries.html">
     4.3. Libraries in Python
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_intro/01_05-01_intro.html">
   5. Formal Coding: Functions, Classes, and Libraries
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_05-02_texts.html">
     5.1. Working with Textual Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_05-03_json.html">
     5.2. Working with JSON Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_05-04_multiple_files.html">
     5.3. Working with Multiple Files
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_intro/01_06-01_intro.html">
   6. Working with Data on the Web
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_06-02_html.html">
     6.1. Introduction to HTML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_intro/01_06-03_scraping_pages.html">
     6.2. Scraping Web Pages with Requests and BeautifulSoup
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PART TWO: Data Analysis with Pandas (Work in Progress)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_pandas/02_01_01_intro.html">
   1. Introduction to Pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_01_02_introduction_to_pandas.html">
     1.1. Introduction to Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_01_03_the_basics.html">
     1.2. The Basics of Pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_pandas/02_02_01_intro.html">
   2. Working with Data in Pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_02_02_finding_data.html">
     2.1. Finding Data in DataFrame
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_02_03_organizing_data.html">
     2.2. Organizing the DataFrame
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_02_04_cleaning_data.html">
     2.3. Cleaning the DataFrame
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_pandas/02_03_01_intro.html">
   3. Searching for Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_03_02_advanced_strings.html">
     3.1. Advanced Searching on Strings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_03_03_advanced_querying.html">
     3.2. Filter and Querying
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_03_04_advanced_grouping.html">
     3.3. Grouping with Groupby()
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_pandas/02_04_01_intro.html">
   4. Advanced Pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_04_02_pandas_and_plots.html">
     4.1. Plotting Data with Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_04_03_graphing_networks_with_pandas.html">
     4.2. Graphing Network Data with Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_pandas/02_04_04_time_series_data.html">
     4.3. Time Series Data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PART THREE: Natural Language Processing with spaCy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03_spacy/03_01_01_intro.html">
   1. Introduction to spaCy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_01_02_install_and_containers.html">
     1.1. The Basics of spaCy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_01_03_linguistic_annotations.html">
     1.2. Getting Started with spaCy and its Linguistic Annotations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_01_04_pipelines.html">
     1.3. spaCy’s Pipelines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03_spacy/03_02_01_intro.html">
   2. Rules-Based spaCy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_02_02_entityruler.html">
     2.1. The EntityRuler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_02_03_matcher.html">
     2.2. The Matcher
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_02_04_phrase_matcher.html">
     2.3. The PhraseMatcher
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_02_06_simple_regex.html">
     2.4. Using RegEx with spaCy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_02_07_complex_regex.html">
     2.5. Working with Multi-Word Token Entities and RegEx in spaCy 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03_spacy/03_03_01_intro.html">
   3. Solving a Domain-Specific Problem: A Case Study with Holocaust NER
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_03_02_cultivating_concentration_camp_dataset.html">
     3.1. Cultivating Good Datasets for Entities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_03_03_challenges.html">
     3.2. The Challenges of Holocaust NER
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_spacy/03_03_04_building_holocaust_pipeline_rules_based.html">
     3.3. Creating Rules-Based Pipeline for Holocaust Documents
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PART FOUR: OTHER APPLICATIONS OF PYTHON
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="04_01_01_intro.html">
   1. Topic Modeling in Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="04_01_02_topic_modeling_concepts.html">
     1.1. What is Topic Modeling?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_01_03_clusters.html">
     1.2. Topics and Clusters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_01_04_bigrams.html">
     1.3. Bigrams and Trigrams
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_02_02_lda_concept.html">
     1.4. LDA Topic Modeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_02_06_lda.html">
     1.5. Creating LDA in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_03_03_embedding_clustering.html">
     1.6. Transformer Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_03_04_top2vec.html">
     1.7. Top2Vec in Python
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08_booknlp/01_01_intro.html">
   2. Text Analysis with BookNLP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08_booknlp/01_intro.html">
     2.1. Introduction to BookNLP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08_booknlp/02_starting.html">
     2.2. Getting Started with BookNLP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08_booknlp/03_files.html">
     2.3. The Output Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08_booknlp/04_character_analysis.html">
     2.4. Character Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08_booknlp/05_events.html">
     2.5. Events Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06_sna/06_01_01_intro.html">
   3. Social Network Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_sna/06_01_02_basics.html">
     3.1. The Basic Concepts of Social Network Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_sna/06_01_03_networkx.html">
     3.2. Introduction to NetworkX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_sna/06_01_04_pyvis_basics.html">
     3.3. Producing Dynamic Graphs with PyVis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_sna/06_01_05_networkx_pyvis.html">
     3.4. NetworkX and PyVis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_sna/06_01_06_node_color.html">
     3.5. Adding Color to Nodes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_sna/06_01_07_applied.html">
     3.6. SNA on Humanities Data: Structuring the Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_sna/06_01_08_applied2.html">
     3.8. SNA on Humanities Data: Creating the Graph
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PART FIVE: DESIGNING AN APPLICATION WITH STREAMLIT
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05_streamlit/05_01_01_intro.html">
   1. Introduction to Streamlit
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_01_02_streamlit.html">
     1.1. Creating Our First App
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_01_03_displaying_data.html">
     1.2. Displaying Data in Streamlit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_01_04_input_widgets.html">
     1.3. Streamlit Input Widgets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05_streamlit/05_02_01_intro.html">
   2. Advanced Streamlit Features
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_02_02_charts.html">
     2.1. Data Visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_02_03_layout_design.html">
     2.2. Layout Design
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_02_04_cache.html">
     2.3. Streamlit Cache and Session States
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_02_05_custom_html.html">
     2.5. Custom HTML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_02_06_multiple_pages.html">
     2.6. Multi-Page Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05_streamlit/05_03_01_intro.html">
   3. Building a Database Query Application
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_03_02_database_query_app.html">
     3.1. Building a Database Query Application
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_streamlit/05_03_03_cloud.html">
     3.2. Deploying an App in the Cloud with Streamlit Share
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/wjbmattingly/python_for_dh/main?urlpath=tree/04_topic_modeling/04_02_05_tfidf_build.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/wjbmattingly/python_for_dh/blob/main/04_topic_modeling/04_02_05_tfidf_build.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/wjbmattingly/python_for_dh"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/wjbmattingly/python_for_dh/issues/new?title=Issue%20on%20page%20%2F04_topic_modeling/04_02_05_tfidf_build.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/wjbmattingly/python_for_dh/edit/main/04_topic_modeling/04_02_05_tfidf_build.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/04_topic_modeling/04_02_05_tfidf_build.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparing-the-data">
   Preparing the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-the-data">
   Cleaning the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementing-tf-idf-in-python">
   Implementing TF-IDF in Python
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#k-means-clustering">
   K-Means Clustering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-the-data">
   Plotting the Data
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>TF-IDF with Scikit Learn</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparing-the-data">
   Preparing the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-the-data">
   Cleaning the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementing-tf-idf-in-python">
   Implementing TF-IDF in Python
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#k-means-clustering">
   K-Means Clustering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-the-data">
   Plotting the Data
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="tf-idf-with-scikit-learn">
<h1>TF-IDF with Scikit Learn<a class="headerlink" href="#tf-idf-with-scikit-learn" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Up until now, we have explored the key concepts of TF-IDF. Here, we will begin to implement the TF-IDF algorithm from Scikit-Learn, but before we do that, we have to consider one very important thing: the state of our data. Whenever you are using algorithms, it is always <em>essential</em> to think about what form does the algorithm expect. The first part of this notebook will, therefore, be dedicated to explaining the data and preparing it for the TF-IDF algorithm.</p>
</section>
<section id="preparing-the-data">
<h2>Preparing the Data<a class="headerlink" href="#preparing-the-data" title="Permalink to this headline">#</a></h2>
<p>In this section of the notebook we will begin importing and manipulating and working with our TRC dataset and in order to do that you need to be familiar with how to import JSON data in Python so in this first block of code we will be doing just that.  I always find that writing out a basic function for reading Json data is always useful because you can use the function throughout your script without having to write 3 lines of code and instead simply writing one. We are going to call this function load_data.</p>
<p>With this function now in place we can import our JSON data that contains our TRC data set which is under the data subfolder. In the next line, we call this function to achieve that task.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/trc.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ObjectId</th>
      <th>Last</th>
      <th>First</th>
      <th>Description</th>
      <th>Place</th>
      <th>Yr</th>
      <th>Homeland</th>
      <th>Province</th>
      <th>Long</th>
      <th>Lat</th>
      <th>HRV</th>
      <th>ORG</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>AARON</td>
      <td>Thabo Simon</td>
      <td>An ANCYL member who was shot and severely inju...</td>
      <td>Bethulie</td>
      <td>1991.0</td>
      <td>NaN</td>
      <td>Orange Free State</td>
      <td>25.97552</td>
      <td>-30.503290</td>
      <td>shoot|injure</td>
      <td>ANC|ANCYL|Police|SAP</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>ABBOTT</td>
      <td>Montaigne</td>
      <td>A member of the SADF who was severely injured ...</td>
      <td>Messina</td>
      <td>1987.0</td>
      <td>NaN</td>
      <td>Transvaal</td>
      <td>30.039597</td>
      <td>-22.351308</td>
      <td>injure</td>
      <td>SADF</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>ABRAHAM</td>
      <td>Nzaliseko Christopher</td>
      <td>A COSAS supporter who was kicked and beaten wi...</td>
      <td>Mdantsane</td>
      <td>1985.0</td>
      <td>Ciskei</td>
      <td>Cape of Good Hope</td>
      <td>27.6708791</td>
      <td>-32.958623</td>
      <td>beat</td>
      <td>COSAS|Police</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now that we have loaded the data, let’s create two separate objects, one for the anmes in the dataset and another for the descriptions. There are better ways to do this in Python with libraries like Pandas, but I do not want to introduce another library into the mix in this textbook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">descriptions</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">descriptions</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20834
</pre></div>
</div>
</div>
</div>
<p>Now that we have the objects created, it’s probably a good idea to print of the first index of each to make sure that they are what we expect and to print off the length of each list to make sure that they are the same length.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">descriptions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>An ANCYL member who was shot and severely injured by SAP members at Lephoi, Bethulie, Orange Free State (OFS) on 17 April 1991. Police opened fire on a gathering at an ANC supporter&#39;s house following a dispute between two neighbours, one of whom was linked to the ANC and the other to the SAP and a councillor.
</pre></div>
</div>
</div>
</div>
<p>This is precisely what we want to see. Both lists are the same length and index 0 for names aligns with the correct corresponding description. This is also a good chance to see what this data looks like. This description is a fair representation of the format and length of all other descriptions in this dataset.</p>
<p>Below, we will use the names to plot the data on a graph, but for now we will strictly be working with the descriptions list. The reason for this is because these are the texts that we want to cluster through TF-IDF and K-Means.</p>
</section>
<section id="cleaning-the-data">
<h2>Cleaning the Data<a class="headerlink" href="#cleaning-the-data" title="Permalink to this headline">#</a></h2>
<p>Now that we have the data that we need for processing, it is time to start cleaning the data. When cleaning text for TF-IDF and topic modeling, it is often good practice to remove certain things from the text that may throw off the algorithms. The specific things you choose to remove from texts will vary depending on the texts you are working with, but there are generally certain words for each language that you will want to remove. These are called <strong>stop words</strong>.</p>
<p>In English, stop words will be articles, such as <code class="docutils literal notranslate"><span class="pre">'the',</span> <span class="pre">'an',</span> <span class="pre">and</span> <span class="pre">'a'</span> <span class="pre">or</span> <span class="pre">the</span> <span class="pre">verb</span> <span class="pre">'to</span> <span class="pre">be'</span></code>. These words are often removed from texts because they occur so frequently that they offer nothing unique about the texts at hand. In other words, they are so common that they do not aid in the clustering of texts. This is because clustering seeks to find particular features of texts and then identify the texts with common overlapping features. Stop words would make all texts overlap significantly. We remove these words to force clustering to focus on the more important words.</p>
<p>In addition to this, we also often need to develop our own stop words for these specific texts, or a general domain. In our case, these texts have a lot of dates and AC numbers that correspond to other records. While these are significant pieces of metadata, these both throw off the clustering. If we were interested in seeing how dates overlap, there are better ways of performing that task. For those interested, see my <a href="ner.pythonhumanities.com">Named Entity Recognition Textbook</a>.</p>
<p>The functions below will clean our text in the above mentioned manner. There are annotations to explain each section of the code.</p>
<p>In order to run the code below, though, we will first need to download a list of stopwords from NLTK.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package stopwords to
[nltk_data]     /home/wjbmattingly/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">remove_stops</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">stops</span><span class="p">):</span>
    <span class="c1">#uses regex to remove all AC numbers</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;AC\/\d{1,4}\/\d{1,4}&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    
    <span class="c1">#removes all stop words, including months</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">final</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stops</span><span class="p">:</span>
            <span class="n">final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            
    <span class="c1">#reassembles the text without stop words</span>
    <span class="n">final</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
    
    <span class="c1">#removes all punctuation</span>
    <span class="n">final</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">))</span>
    
    <span class="c1">#removes all numbers</span>
    <span class="n">final</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">final</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()])</span>
    
    <span class="c1">#eliminates double white spaces</span>
    <span class="k">while</span> <span class="s2">&quot;  &quot;</span> <span class="ow">in</span> <span class="n">final</span><span class="p">:</span>
        <span class="n">final</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">final</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">clean_docs</span><span class="p">(</span><span class="n">docs</span><span class="p">):</span>
    <span class="c1">#gets the NLTK&#39;s stopword list for English</span>
    <span class="n">stops</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s2">&quot;english&quot;</span><span class="p">)</span>
    
    <span class="c1">#empty new list to store the cleaned docs</span>
    <span class="n">final</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1">#iterate over all docs and cleans them to be a</span>
    <span class="c1">#single sentence with no unwanted words</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
        <span class="n">clean_doc</span> <span class="o">=</span> <span class="n">remove_stops</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">stops</span><span class="p">)</span>
        <span class="n">final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clean_doc</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">final</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now comes the time to clean all of our documents. We will use one line of code to pass all descriptions to clean_docs().</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cleaned_docs</span> <span class="o">=</span> <span class="n">clean_docs</span><span class="p">(</span><span class="n">descriptions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>After cleaning my documents, I always find it is good to print off a sample of the before and after to see that my functions are working as intended. So, let’s do that here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Original Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">descriptions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Cleaned Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">cleaned_docs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Text:
An ANCYL member who was shot and severely injured by SAP members at Lephoi, Bethulie, Orange Free State (OFS) on 17 April 1991. Police opened fire on a gathering at an ANC supporter&#39;s house following a dispute between two neighbours, one of whom was linked to the ANC and the other to the SAP and a councillor.

Cleaned Text:
An ANCYL member shot severely injured SAP members Lephoi Bethulie Orange Free State OFS April Police opened fire gathering ANC supporters house following dispute two neighbours one linked ANC SAP councillor
</pre></div>
</div>
</div>
</div>
<p>As we can see from these two outputs, the original text has been heavily altered and cleaned. Notice, for example, the removal of the date. Now that we have the data fully cleaned, it is time to begin setting up the TF-IDF algorithm with Scikit-Learn.</p>
</section>
<section id="implementing-tf-idf-in-python">
<h2>Implementing TF-IDF in Python<a class="headerlink" href="#implementing-tf-idf-in-python" title="Permalink to this headline">#</a></h2>
<p>Implementing TF-IDF in Python requires us to import a few things from the Scikit Learn library. Remember, in Python Scikit Learn is “sklearn”. So, let’s import those things now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A lot of this section comes from the Scikit Learn documentation and various blogs including the following:</span>
<span class="c1">#https://towardsdatascience.com/applying-machine-learning-to-classify-an-unsupervised-text-document-e7bb6265f52</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</pre></div>
</div>
</div>
</div>
<p>First, we import the TfidfVectorizer. This is going to be what allows us to perform TF-IDF in just a few lines of code. Second, we import KMeans. This will be what allows us to cluster the TF-IDF of each key word in each text.</p>
<p>Now that we have the libraries imported, we can begin to work with them. First, let’s make our vectorizer. This will be our TF-IDF algorithm. It will have several functions that we can call. For now, though, let’s focus on the parameters.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>lowercase</p></td>
<td><p>allows us to lowercase our data.</p></td>
</tr>
<tr class="row-odd"><td><p>max_features</p></td>
<td><p>this is how many words out of the entire corpus we want to take into account. Here, we will use 100. The higher the number, the more computational expensive the tasks are to run. I have chosen 100 for this demonstration somewhat at random, but it works fairly well for our purposes.</p></td>
</tr>
<tr class="row-even"><td><p>max_df</p></td>
<td><p>this is a float that tells the algorithm to ignore any word that occurs in 80% of the documents.</p></td>
</tr>
<tr class="row-odd"><td><p>min_df</p></td>
<td><p>this is an integer that tells the algorithm to ignore words that do not occur more than 5 times in the entire corpus.</p></td>
</tr>
<tr class="row-even"><td><p>ngram_range</p></td>
<td><p>this is a tuple with index 0 being the smallest number of words to consider with the second index being the largest, i.e. 2 for bigram and 3 for trigrams. (1, 3) means the algorithm should consider anything from a unigram (one word) to trigram (three words) as a concept.</p></td>
</tr>
<tr class="row-odd"><td><p>stop_words</p></td>
<td><p>this is the language you are working with and you are telling the algorithm to ignore the predefined set of stopwords. This is a bit excessive since we already did this with NLTK.</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span>
                                <span class="n">lowercase</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">max_features</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                <span class="n">max_df</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                                <span class="n">min_df</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
                                <span class="n">stop_words</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span>

                            <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have created the vectorizer, let’s pass our documents to the algorithm with the method <code class="docutils literal notranslate"><span class="pre">fit_transform()</span></code>. This will pass all documents to the algorithm and vectorize them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">cleaned_docs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here, we can see the results of the vectors of the first document. This output is a tuple which indicates the keyword and the TF-IDF score. In this form, however, it is a bit hard to decipher.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  (0, 5)	0.29723901061151475
  (0, 36)	0.25289259755817356
  (0, 92)	0.1676996522871345
  (0, 2)	0.3397934181035764
  (0, 72)	0.2633613181991394
  (0, 6)	0.30627778192110294
  (0, 56)	0.19535436966172204
  (0, 77)	0.5016519391534785
  (0, 41)	0.23459044720002845
  (0, 80)	0.29258951458997623
  (0, 82)	0.18554060799440944
  (0, 55)	0.27579282750338985
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/wjbmattingly/anaconda3/lib/python3.9/site-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function get_feature_names is deprecated; get_feature_names is deprecated in 1.0 and will be removed in 1.2. Please use get_feature_names_out instead.
  warnings.warn(msg, category=FutureWarning)
</pre></div>
</div>
</div>
</div>
<p>By using the method <code class="docutils literal notranslate"><span class="pre">get_feature_names()</span></code>, we can get an easier to read text representation of our key words. Let’s look at the most common first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">feature_names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>allegedly
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dense</span> <span class="o">=</span> <span class="n">vectors</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>By using the method todense(), we can convert that vector into a larger representation and each word’s TF-IDF score. Each number corresponds to a word. Those words that are keywords have a TF-IDF score, while those represented by 0 are words that did not make it into our max_features. In other words, they are irrelevant words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dense</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.         0.         0.33979342 0.         0.         0.29723901
  0.30627778 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.2528926  0.         0.         0.         0.         0.23459045
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.27579283 0.19535437 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.26336132 0.         0.         0.         0.         0.50165194
  0.         0.         0.29258951 0.         0.18554061 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.16769965 0.         0.         0.
  0.         0.         0.         0.        ]]
</pre></div>
</div>
</div>
</div>
<p>To work with this data, let’s reconvert it into a list with the command below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">denselist</span> <span class="o">=</span> <span class="n">dense</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This is what that same data looks like when printed off as a list. Again, this is our first document represented with its TF-IDF scores for each word.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">denselist</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 0.0, 0.3397934181035764, 0.0, 0.0, 0.29723901061151475, 0.30627778192110294, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25289259755817356, 0.0, 0.0, 0.0, 0.0, 0.23459044720002845, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.27579282750338985, 0.19535436966172204, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2633613181991394, 0.0, 0.0, 0.0, 0.0, 0.5016519391534785, 0.0, 0.0, 0.29258951458997623, 0.0, 0.18554060799440944, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1676996522871345, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
</div>
</div>
<p>Now, let’s convert every document from its TF-IDF scores to a list of key words. This will be essential for clustering below. In the code below, we run each description across the denselist and check if each word appears in the denselist. If it does (i.e. if it is one of the 100 important max feature words), then we keep it and append that list of words to all_keywords. This object will be all the documents in a list. Each index (document) will now be a list of words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_keywords</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">denselist</span><span class="p">:</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">keywords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">description</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_names</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">all_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at what we have been able to do to our document 0 by looking at its original state, cleaned state, and just the key words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">descriptions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cleaned Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cleaned_docs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Only Keywords Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Text:
An ANCYL member who was shot and severely injured by SAP members at Lephoi, Bethulie, Orange Free State (OFS) on 17 April 1991. Police opened fire on a gathering at an ANC supporter&#39;s house following a dispute between two neighbours, one of whom was linked to the ANC and the other to the SAP and a councillor.

Cleaned Text:
An ANCYL member shot severely injured SAP members Lephoi Bethulie Orange Free State OFS April Police opened fire gathering ANC supporters house following dispute two neighbours one linked ANC SAP councillor

Only Keywords Text:
[&#39;anc&#39;, &#39;anc supporters&#39;, &#39;april&#39;, &#39;house&#39;, &#39;injured&#39;, &#39;member&#39;, &#39;members&#39;, &#39;police&#39;, &#39;sap&#39;, &#39;severely&#39;, &#39;shot&#39;, &#39;supporters&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="k-means-clustering">
<h2>K-Means Clustering<a class="headerlink" href="#k-means-clustering" title="Permalink to this headline">#</a></h2>
<p>Now that our data is nothing more than a list of lists of key words for each document, we can use these features to see where there is overlap. This is called clustering and one method of clustering is K-Means which seeks to place every document into a cluster to which it has the most similarity. In the below code, we define true_k as the number of clusters. In this example, I am telling it to find 5 clusters. In the video below, I used 20, but as we will see for plotting it is easier to have 5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">true_k</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">true_k</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s2">&quot;k-means++&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have created the K-Means model, its time to cluster the data. We will do this by fitting the vectors to the model. In this scenario, we are using the TF-IDF scores from the descriptions to formulate the basis for our clusters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
<span class="n">order_centroids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/wjbmattingly/anaconda3/lib/python3.9/site-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function get_feature_names is deprecated; get_feature_names is deprecated in 1.0 and will be removed in 1.2. Please use get_feature_names_out instead.
  warnings.warn(msg, category=FutureWarning)
</pre></div>
</div>
</div>
</div>
<p>Now that we have done that, let’s see what our 5 clusters look like as arrays. These arrays are a list of the keywords most associated with each cluster represented by their numerical value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">order_centroids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[72 56 55 21 28 82 15  2 61 80 16 96 41 78 60 94 95 88 48 54 98 47 81  0
  10 97 25 45 35 29 11 22 79 17 86 73 26 24 14 46 69  6 83 44  3  1 99 84
  87 66 77 36 67 92 32  7 31 33 71 34 18 64 12 74 76 58 30 38 13 70  8 62
  27  5  9 51 42 90 23 68 40 75 49 50 43 65 52 37 39  4 59 91 53 93 57 89
  20 19 63 85]
 [38  2 82 92 83 24 88 90 40  3 62  4 91 64 22  5 51 52 41 39 73 87  7  6
  11 48  0 61 74 76 25 96 84 30 56 54 79 26 35 14 93 42 12 66 46 32 23 69
  75 97 65 31 67 47 60 55 43 29 44 45 80 72 71 98 53 18 36  1 86 13 77 49
  50 70 99 34 33 15 57 10 21 78 37 68 63 81  8 17 27 58 95  9 19 20 89 16
  85 28 94 59]
 [92 18 64 36 38 30 22 35  2 51 52 42  8 40 88 73 74 11 65  7 85 53 62  9
  89 43 19  3 20 37  5 32 49 98 54 50 27 23 63 75 13 93  6 25 87  0 48 39
  44 46 12 26 60 99 69 47 31 61 41 76 82 66 14 79 67 70 80 55 56  1 71 29
  34 33 96 84 24 72 15 90 83 10 81 16 97 77 45 17 57 21 86  4 95 78 94 68
  91 28 58 59]
 [58 68  1 33 34 41 59 48 69 11 96 70 56 71 78 47 17 46 13 55 24 64 82 45
   2 30 80 72 97 26  6 54 84 38 21 12 83 66 67 77 40 92 60 44 29 95 86 62
  14 35 32 79 16 36  0 31 76 98 99 88 27 65 42 25 73 94 52 51  7 87 10 74
  22 43 39 28 61 90 18  8  9  3 57 49 50  5 53 15  4 81 91 85 89 19 75 23
  63 93 37 20]
 [57 77 56 82 21 72 15 80 96 28 83 24 94 41 54 86 55 47 81 61 84 88 97 10
   2 60  0 14  3 45 95 98 73 79 99  6 66 46  7 22 48 76 69 32 90 26 67 44
  35 64 29 74 36 25 58  4 62 11 70 31 30 91  8 92 18 51 78 38 52 12  9 23
  87 16 75 17 71  5 27 40 65 49 42 93 50 68 13 37  1 43 59 53 33 34 89 39
  63 19 20 85]]
</pre></div>
</div>
</div>
</div>
<p>Let’s look at the first word from the first cluster, number 92. We can find that word by looking it up in our terms list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="mi">92</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>supporters
</pre></div>
</div>
</div>
</div>
<p>Since we can do that with one word, we can automate the entire process of converting all numbers into a list of key words for each cluster with the below code. Here, I am limiting the list to just the first 10 words for each cluster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">order_centroids</span><span class="p">[:</span><span class="mi">1</span><span class="p">]):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">cluster</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="n">keyword</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster 0
police
members
member
cape
detained
shot
beaten
anc
named
severely
</pre></div>
</div>
</div>
</div>
<p>And Viola, just like that we have all 22,000 descriptions clusterd into 5 categories. I know what you may be thinking, though. How do we see where those documents are. The answer is addressed below when we plot the data. In order to walk through this portion of notebook, check out the video below.</p>
</section>
<section id="plotting-the-data">
<h2>Plotting the Data<a class="headerlink" href="#plotting-the-data" title="Permalink to this headline">#</a></h2>
<p>This portion of the notebook is perhaps best illustrated with the video below. The code below has already been executed so that you can see the data plotted out on a graph. Each node on the graph represents a description. Each color represents a cluster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#A lot of this section was obtained from https://stackoverflow.com/questions/27494202/how-do-i-visualize-data-points-of-tf-idf-vectors-for-kmeans-clustering</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmean_indices</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">scatter_plot_points</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">vectors</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>

<span class="n">x_axis</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">scatter_plot_points</span><span class="p">]</span>
<span class="n">y_axis</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">scatter_plot_points</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">kmean_indices</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f8fe6198970&gt;
</pre></div>
</div>
<img alt="../_images/04_02_05_tfidf_build_61_1.png" src="../_images/04_02_05_tfidf_build_61_1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./04_topic_modeling"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By William J.B. Mattingly<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>